<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Planos - Abot Youtube</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-[#0f0f0f] text-white font-sans">
    <!-- Background Effects -->
    <div class="fixed inset-0 z-[-1] overflow-hidden pointer-events-none">
      <div
        class="absolute top-0 left-1/4 w-96 h-96 bg-red-900/20 rounded-full blur-[128px]"
      ></div>
      <div
        class="absolute bottom-0 right-1/4 w-96 h-96 bg-blue-900/10 rounded-full blur-[128px]"
      ></div>
    </div>

    <div class="max-w-7xl mx-auto px-4 py-20">
      <!-- Header -->
      <div class="text-center mb-16">
        <span class="text-red-500 font-bold tracking-wider text-sm uppercase"
          >Seja um Creator de Elite</span
        >
        <h1
          class="text-5xl md:text-6xl font-extrabold mb-6 mt-2 bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400"
        >
          Desbloqueie o Poder da Automa√ß√£o
        </h1>
        <p class="text-gray-400 text-lg max-w-2xl mx-auto">
          Pare de perder tempo comentando manualmente. O Abot Youtube trabalha
          24/7 para crescer seu canal enquanto voc√™ cria conte√∫do.
        </p>
      </div>

      <!-- Pricing Grid -->
      <div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto items-center">
        <!-- Free -->
        <div
          class="p-8 bg-[#161616] rounded-3xl border border-gray-800 flex flex-col hover:border-gray-600 transition duration-300"
        >
          <h3 class="text-xl font-medium text-gray-400 mb-2">Iniciante</h3>
          <div class="text-5xl font-bold mb-2 text-white">R$ 0</div>
          <p class="text-gray-500 text-sm mb-8">
            Para quem est√° testando a ferramenta.
          </p>

          <ul class="space-y-4 mb-8 flex-1 text-gray-300 text-sm">
            <li class="flex items-center gap-3">
              <svg
                class="w-5 h-5 text-gray-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 13l4 4L19 7"
                ></path>
              </svg>
              10 Cr√©ditos de envio
            </li>
            <li class="flex items-center gap-3">
              <svg
                class="w-5 h-5 text-gray-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 13l4 4L19 7"
                ></path>
              </svg>
              Acesso ao Feed de V√≠deos
            </li>
            <li class="flex items-center gap-3 text-gray-600">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
              Sem Modo Autom√°tico (Loop)
            </li>
          </ul>
          <a
            href="/login"
            class="block text-center py-4 border border-gray-700 rounded-xl text-gray-300 font-bold hover:bg-gray-800 transition"
            >Criar Conta Gr√°tis</a
          >
        </div>

        <!-- Pro -->
        <div
          class="relative p-8 bg-[#1a1a1a] rounded-3xl border-2 border-red-600 flex flex-col shadow-[0_0_40px_rgba(220,38,38,0.3)] transform md:scale-105 z-10"
        >
          <div
            class="absolute -top-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-red-600 to-orange-600 text-white text-xs font-bold px-4 py-1 rounded-full shadow-lg tracking-wide uppercase"
          >
            Recomendado
          </div>

          <h3 class="text-xl font-bold text-red-500 mb-2">Abot PRO üíé</h3>
          <div class="flex items-end gap-2 mb-2">
            <div class="text-5xl font-bold text-white">
              R$ {{ "%.2f"|format(price/100)|replace('.', ',') }}
            </div>
            <span class="text-gray-400 mb-2">/m√™s</span>
          </div>
          <p
            class="text-green-400 text-xs font-bold mb-8 bg-green-900/20 inline-block py-1 px-2 rounded w-fit"
          >
            ‚ö° Menos de R$ 1,00 por dia
          </p>

          <ul class="space-y-4 mb-8 flex-1 text-white text-sm">
            <li class="flex items-center gap-3">
              <div class="bg-red-600/20 p-1 rounded-full">
                <svg
                  class="w-4 h-4 text-red-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="3"
                    d="M5 13l4 4L19 7"
                  ></path>
                </svg>
              </div>
              <span class="font-bold">Envios Ilimitados</span>
            </li>
            <li class="flex items-center gap-3">
              <div class="bg-red-600/20 p-1 rounded-full">
                <svg
                  class="w-4 h-4 text-red-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="3"
                    d="M5 13l4 4L19 7"
                  ></path>
                </svg>
              </div>
              <span>Modo Autom√°tico (Loop Infinito)</span>
            </li>
            <li class="flex items-center gap-3">
              <div class="bg-red-600/20 p-1 rounded-full">
                <svg
                  class="w-4 h-4 text-red-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="3"
                    d="M5 13l4 4L19 7"
                  ></path>
                </svg>
              </div>
              <span>Prioridade na Fila de Processamento</span>
            </li>
            <li class="flex items-center gap-3">
              <div class="bg-red-600/20 p-1 rounded-full">
                <svg
                  class="w-4 h-4 text-red-500"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="3"
                    d="M5 13l4 4L19 7"
                  ></path>
                </svg>
              </div>
              <span>Suporte VIP via WhatsApp</span>
            </li>
          </ul>

          <a
            href="#"
            id="btnSubscribe"
            class="block text-center py-4 bg-gradient-to-r from-red-600 to-red-700 text-white font-bold rounded-xl hover:from-red-500 hover:to-red-600 transition shadow-lg shadow-red-900/40 transform hover:-translate-y-1"
            >QUERO ACESSO ILIMITADO</a
          >

          <div
            class="mt-4 flex items-center justify-center gap-2 text-[10px] text-gray-500"
          >
            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"
              />
            </svg>
            <span>Pagamento Seguro via PIX</span>
            <span class="mx-1">‚Ä¢</span>
            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"
              />
            </svg>
            <span>Acesso Imediato</span>
          </div>
        </div>
      </div>

      <!-- FAQ Section -->
      <div class="max-w-3xl mx-auto mt-24">
        <h2 class="text-2xl font-bold text-center mb-8">
          Perguntas Frequentes
        </h2>
        <div class="space-y-4">
          <div class="bg-[#161616] p-6 rounded-xl border border-gray-800">
            <h4 class="font-bold text-white mb-2">O pagamento √© seguro?</h4>
            <p class="text-gray-400 text-sm">
              Sim! Utilizamos o AbacatePay, uma das plataformas mais seguras do
              Brasil. Seus dados s√£o criptografados e o acesso √© liberado
              automaticamente ap√≥s o PIX.
            </p>
          </div>
          <div class="bg-[#161616] p-6 rounded-xl border border-gray-800">
            <h4 class="font-bold text-white mb-2">
              Posso cancelar quando quiser?
            </h4>
            <p class="text-gray-400 text-sm">
              Com certeza. Voc√™ tem total controle no seu painel. Se cancelar,
              continua com acesso at√© o fim do per√≠odo pago.
            </p>
          </div>
          <div class="bg-[#161616] p-6 rounded-xl border border-gray-800">
            <h4 class="font-bold text-white mb-2">
              Existe risco para meu canal?
            </h4>
            <p class="text-gray-400 text-sm">
              O Abot Youtube simula o comportamento humano e respeita os limites
              da API. Por√©m, recomendamos sempre usar com modera√ß√£o e evitar
              spam repetitivo.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- RODAP√â LEGAL -->
    <div
      class="max-w-4xl mx-auto px-4 pb-20 pt-10 text-center text-gray-600 text-xs space-y-2 border-t border-gray-900 mt-10"
    >
      <div class="flex justify-center gap-4 mb-4 opacity-50">
        <!-- √çcones de Garantia (Simulados com texto/svg simples para n√£o carregar imagens externas) -->
        <div class="flex items-center gap-1">
          <span class="text-xl">üõ°Ô∏è</span> 7 Dias de Garantia
        </div>
        <div class="flex items-center gap-1">
          <span class="text-xl">üîí</span> Site Seguro
        </div>
      </div>
      <p>
        <strong>Renova√ß√£o e Cancelamento:</strong> O plano PRO √© uma assinatura
        mensal. Voc√™ receber√° um lembrete 3 dias antes do vencimento. O
        cancelamento pode ser solicitado a qualquer momento no painel,
        interrompendo cobran√ßas futuras.
      </p>
      <p>
        <strong>Garantia:</strong> De acordo com o Art. 49 do CDC, voc√™ tem 7
        dias de garantia para solicitar reembolso integral caso n√£o esteja
        satisfeito com o Abot Youtube.
      </p>
    </div>

    <!-- MODAL PIX TRANSPARENTE -->
    <div
      id="pixModal"
      class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black/80 backdrop-blur-sm"
    >
      <div
        class="bg-[#1e1e1e] border border-gray-700 p-6 rounded-2xl max-w-md w-full mx-4 text-center shadow-2xl"
      >
        <h3 class="text-2xl font-bold mb-4 text-white">Pagamento via PIX</h3>
        <p class="text-gray-400 text-sm mb-4">
          Escaneie o QR Code ou copie o c√≥digo abaixo para liberar seu acesso
          instantaneamente.
        </p>

        <div class="bg-white p-2 rounded-lg inline-block mb-4">
          <img
            id="pixQr"
            src=""
            alt="QR Code PIX"
            class="w-48 h-48 object-contain mx-auto"
          />
        </div>

        <div class="relative mb-6">
          <input
            type="text"
            id="pixCode"
            readonly
            class="w-full bg-[#121212] border border-gray-700 text-gray-300 text-xs p-3 rounded pr-20 focus:outline-none focus:border-red-600"
          />
          <button
            onclick="copyPix()"
            class="absolute right-1 top-1 bottom-1 px-3 bg-gray-800 hover:bg-gray-700 text-white text-xs font-bold rounded transition"
          >
            COPIAR
          </button>
        </div>

        <div class="flex gap-3 justify-center">
          <button
            onclick="closePixModal()"
            class="px-6 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-800 transition"
          >
            Fechar
          </button>
          <a
            href="/app"
            class="px-6 py-2 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition flex items-center gap-2"
          >
            <span>J√° Paguei</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="/static/js/firebase-config.js"></script>

    <script>
      let pollInterval;
      document
        .getElementById("btnSubscribe")
        .addEventListener("click", async (e) => {
          e.preventDefault();
          const user = auth.currentUser;

          if (!user) {
            // Salva a inten√ß√£o de compra para redirecionar depois do login (opcional)
            window.location.href = "/login?redirect=plans";
          } else {
            const btn = document.getElementById("btnSubscribe");
            const originalText = btn.innerText;

            // Evita m√∫ltiplos cliques
            if (btn.getAttribute("data-loading") === "true") return;

            btn.setAttribute("data-loading", "true");
            btn.innerText = "Processando...";
            // Em tags <a>, disabled n√£o funciona nativamente, usamos data-loading
            btn.classList.add("opacity-50", "cursor-not-allowed");

            try {
              const token = await user.getIdToken();
              const response = await fetch("/create_checkout", {
                method: "POST",
                headers: { Authorization: `Bearer ${token}` },
              });

              // Verifica se a resposta √© v√°lida antes de tentar ler o JSON
              if (!response.ok) {
                const errText = await response.text();
                throw new Error(
                  `Erro no servidor (${response.status}): ${errText}`,
                );
              }

              const data = await response.json();
              console.log("Dados do Checkout:", data); // Verifique o console (F12) se der erro

              if (data.status === "success") {
                if (data.pix && data.pix.code) {
                  // Exibe Modal PIX Transparente
                  document
                    .getElementById("pixModal")
                    .classList.remove("hidden");
                  document.getElementById("pixCode").value = data.pix.code;
                  if (data.pix.qr_code)
                    document.getElementById("pixQr").src = data.pix.qr_code;

                  startPolling();
                } else if (data.url) {
                  console.warn(
                    "PIX n√£o encontrado, redirecionando para URL:",
                    data.url,
                  );
                  // Se n√£o tiver PIX (ex: cart√£o), redireciona. Se quiser for√ßar PIX, remova este else if.
                  window.location.href = data.url;
                }
              } else {
                throw new Error(
                  data.message || "Erro desconhecido ao criar checkout.",
                );
              }
            } catch (err) {
              console.error(err);
              // Tenta extrair mensagem de erro limpa se for JSON no erro
              let msg = err.message;
              if (msg.includes('"message":')) {
                try {
                  msg = JSON.parse(msg).message;
                } catch (e) {}
              }
              alert("Falha no pagamento: " + msg);
            } finally {
              // Sempre restaura o bot√£o, independente de sucesso ou erro
              btn.innerText = originalText;
              btn.removeAttribute("data-loading");
              btn.classList.remove("opacity-50", "cursor-not-allowed");
            }
          }
        });

      function closePixModal() {
        document.getElementById("pixModal").classList.add("hidden");
        if (pollInterval) clearInterval(pollInterval);
      }

      function copyPix() {
        const copyText = document.getElementById("pixCode");
        copyText.select();
        navigator.clipboard
          .writeText(copyText.value)
          .then(() => alert("C√≥digo PIX copiado!"));
      }

      function startPolling() {
        if (pollInterval) clearInterval(pollInterval);
        pollInterval = setInterval(async () => {
          try {
            const user = auth.currentUser;
            if (!user) return;
            const token = await user.getIdToken();
            const res = await fetch("/api/check_status", {
              headers: { Authorization: `Bearer ${token}` },
            });
            const data = await res.json();
            if (data.status === "approved") {
              clearInterval(pollInterval);
              window.location.href = "/thank-you";
            }
          } catch (e) {
            console.error("Erro no polling:", e);
          }
        }, 3000);
      }
    </script>
  </body>
</html>
