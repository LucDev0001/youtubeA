<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Planos - YouTube Bot</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-[#0f0f0f] text-white font-sans">
    <div class="max-w-6xl mx-auto px-4 py-20">
      <div class="text-center mb-16">
        <h1 class="text-4xl font-bold mb-4">Escolha o plano ideal</h1>
        <p class="text-gray-400">Desbloqueie todo o potencial do seu canal.</p>
      </div>

      <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
        <!-- Free -->
        <div
          class="p-8 bg-[#1e1e1e] rounded-2xl border border-gray-800 flex flex-col"
        >
          <h3 class="text-2xl font-bold mb-2">Gratuito</h3>
          <div class="text-4xl font-bold mb-6">
            R$ 0<span class="text-lg text-gray-500 font-normal">/mês</span>
          </div>
          <ul class="space-y-4 mb-8 flex-1 text-gray-300">
            <li>✅ 10 Créditos de envio</li>
            <li>✅ Acesso ao Feed de Vídeos</li>
            <li>❌ Automação Limitada</li>
          </ul>
          <a
            href="/login"
            class="block text-center py-3 border border-gray-600 rounded-lg hover:bg-gray-800"
            >Começar Grátis</a
          >
        </div>

        <!-- Pro -->
        <div
          class="p-8 bg-gradient-to-b from-red-900 to-[#1e1e1e] rounded-2xl border border-red-600 flex flex-col relative overflow-hidden"
        >
          <div
            class="absolute top-0 right-0 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg"
          >
            POPULAR
          </div>
          <h3 class="text-2xl font-bold mb-2">PRO</h3>
          <div class="text-4xl font-bold mb-6">
            R$ 29,90<span class="text-lg text-gray-300 font-normal">/mês</span>
          </div>
          <ul class="space-y-4 mb-8 flex-1 text-white">
            <li>✅ Envios Ilimitados</li>
            <li>✅ Automação Completa (Loop)</li>
            <li>✅ Suporte Prioritário</li>
            <li>✅ Templates Personalizados</li>
          </ul>
          <a
            href="#"
            id="btnSubscribe"
            class="block text-center py-3 bg-white text-black font-bold rounded-lg hover:bg-gray-200 transition"
            >Assinar Agora</a
          >
        </div>
      </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="/static/js/firebase-config.js"></script>

    <script>
      document
        .getElementById("btnSubscribe")
        .addEventListener("click", async (e) => {
          e.preventDefault();
          const user = auth.currentUser;

          if (!user) {
            // Salva a intenção de compra para redirecionar depois do login (opcional)
            window.location.href = "/login?redirect=plans";
          } else {
            const btn = document.getElementById("btnSubscribe");
            btn.innerText = "Processando...";
            btn.disabled = true;

            try {
              const token = await user.getIdToken();
              const response = await fetch("/create_checkout", {
                method: "POST",
                headers: { Authorization: `Bearer ${token}` },
              });
              const data = await response.json();

              if (data.status === "success" && data.url) {
                window.location.href = data.url; // Redireciona para o pagamento
              } else {
                alert(
                  "Erro ao iniciar pagamento: " +
                    (data.message || "Tente novamente."),
                );
                btn.innerText = "Assinar Agora";
                btn.disabled = false;
              }
            } catch (err) {
              console.error(err);
              alert("Erro de conexão.");
              btn.innerText = "Assinar Agora";
              btn.disabled = false;
            }
          }
        });
    </script>
  </body>
</html>
